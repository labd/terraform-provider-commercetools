---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "commercetools_api_extension Resource - terraform-provider-commercetools"
subcategory: ""
description: |-
  Create a new API extension to extend the bevahiour of an API with business logic. Note that API extensions affect the performance of the API it is extending. If it fails, the whole API call fails
  Also see the API Extension API Documentation https://docs.commercetools.com/api/projects/api-extensions
---

# commercetools_api_extension (Resource)

Create a new API extension to extend the bevahiour of an API with business logic. Note that API extensions affect the performance of the API it is extending. If it fails, the whole API call fails 

Also see the [API Extension API Documentation](https://docs.commercetools.com/api/projects/api-extensions)

## Example Usage

```terraform
# HTTP api extension
resource "commercetools_api_extension" "my-http-extension" {
  key = "my-http-extension-key"

  destination {
    type                 = "HTTP"
    url                  = "https://example.com"
    authorization_header = "Basic 12345"
  }

  trigger {
    resource_type_id = "customer"
    actions          = ["Create", "Update"]
  }
}

# AWS Lambda api extension
resource "commercetools_api_extension" "my-awslambda-extension" {
  key = "my-awslambda-extension-key"

  destination {
    type          = "awslambda"
    arn           = "us-east-1:123456789012:mylambda"
    access_key    = "mykey"
    access_secret = "mysecret"
  }

  trigger {
    resource_type_id = "customer"
    actions          = ["Create", "Update"]
  }
}

# Google Cloud Function api extension
resource "commercetools_api_extension" "my-googlecloudfunction-extension" {
  key = "my-googlecloudfunction-extension-key"

  destination {
    type = "googlecloudfunction"
    url  = "https://example.com"
  }

  trigger {
    resource_type_id = "customer"
    actions          = ["Create", "Update"]
  }
}

resource "google_cloudfunctions_function" "my_cloud_function" {
  name        = "function-test"
  description = "My function"
  runtime     = "nodejs16"

  # See https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/cloudfunctions_function for any
  # further settings
}

resource "google_cloudfunctions_function_iam_member" "invoker" {
  # For GoogleCloudFunction destinations, you need to grant permissions to the
  # <extensions@commercetools-platform.iam.gserviceaccount.com> service account to invoke your function.
  project        = "my-project"
  region         = "europe-central2"
  cloud_function = google_cloudfunctions_function.my_cloud_function.name

  # If your function's version is 1st gen, grant the service account the IAM role Cloud Functions Invoker
  role = "roles/cloudfunctions.invoker"
  # For version 2nd gen, assign the IAM role Cloud Run Invoker
  # role   = "roles/run.invoker"
  member = "serviceAccount:extensions@commercetools-platform.iam.gserviceaccount.com"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `destination` (Block List, Min: 1, Max: 1) [Destination](https://docs.commercetools.com/api/projects/api-extensions#destination) Details where the extension can be reached (see [below for nested schema](#nestedblock--destination))
- `trigger` (Block List, Min: 1) Array of [Trigger](https://docs.commercetools.com/api/projects/api-extensions#trigger) Describes what triggers the extension (see [below for nested schema](#nestedblock--trigger))

### Optional

- `key` (String) User-specific unique identifier for the extension
- `timeout_in_ms` (Number) Extension timeout in milliseconds

### Read-Only

- `id` (String) The ID of this resource.
- `version` (Number)

<a id="nestedblock--destination"></a>
### Nested Schema for `destination`

Required:

- `type` (String)

Optional:

- `access_key` (String)
- `access_secret` (String, Sensitive)
- `arn` (String)
- `authorization_header` (String)
- `azure_authentication` (String)
- `url` (String)


<a id="nestedblock--trigger"></a>
### Nested Schema for `trigger`

Required:

- `actions` (List of String) Currently, Create and Update are supported
- `resource_type_id` (String) Currently, cart, order, payment, and customer are supported

Optional:

- `condition` (String) Valid predicate that controls the conditions under which the API Extension is called.
