language: go

services:
  - docker

env:
  global:
    - TF_ACC=1
    - CTP_AUTH_URL=http://localhost:8989
    - CTP_PROJECT_KEY=unittest
    - CTP_API_URL=http://localhost:8989
    - CTP_CLIENT_ID=unittest
    - CTP_CLIENT_SECRET=x

go:
  - "1.11"

before_install:
  - docker pull labdigital/commercetools-mock-server
  - docker run -d -p 127.0.0.1:8989:8989 labdigital/commercetools-mock-server


script:
  - env GO111MODULE=on go test -race -coverprofile=coverage.txt -covermode=atomic -coverpkg=./... -v ./...

after_success:
  - bash <(curl -s https://codecov.io/bash)
